/*
 * This file was generated by the Gradle 'init' task.
 *
 * This is a general purpose Gradle build.
 * Learn more about Gradle by exploring our Samples at https://docs.gradle.org/8.11.1/samples
 * This project uses @Incubating APIs which are subject to change.
 */

println "configuration phase"
println "gradle id: ${gradle.hashCode()}"
println "root: ${rootProject.hashCode()}, ${project.hashCode()}, ${gradle.rootProject}"
println "project: ${name}"

//
task hello(description: "Hello task", group: "dmdev", type: DefaultTask) {
    println "configuration phase. hello"
    println "taks $description, group : $group, actions : ${actions.size()},"

    doLast {
        println "execution phase, Action 2"
    }

    doLast {
        println "execution phase, Action 3"
    }

    doFirst {
        println "execution phase, Action 1"
    }

    println "path task : $path,"
}

task first {
    doLast {
        println "Task 1"
    }
}

task second {
    doLast {
        println "Task 2"
    }
}

task third {
    doLast {
        println "Task 3"
    }
}

task fourth(group: "dmdev") {
    doLast {
        println "Task 4"
    }
}

//fourth.dependsOn second
//second.dependsOn first
//second.finalizedBy third
fourth.dependsOn first
fourth.dependsOn second
fourth.dependsOn third

first.mustRunAfter second
// second.shouldRunAfter first


gradle.taskGraph.whenReady { TaskExecutionGraph graph ->
    println "---- Graph:"
    graph.allTasks.each {
        println "${it.name}"
    }
}

gradle.taskGraph.beforeTask { Task task ->
    if (task.group=="dmdev") {
        println "Before Task : $task"
    }
}

gradle.taskGraph.afterTask { task ->
    if (task.group=="dmdev") {
        println "After Task : $task"
    }
}

defaultTasks("second")

// 2
// 1   4
// 3
